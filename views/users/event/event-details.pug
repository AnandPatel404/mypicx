extends ../../layout/event/event-details
block content 
	include ../../components/users/bottom_menu
	.row 
		.col-12
			.card 
				.card-header.card-header.d-flex.align-items-center.justify-content-between.gap-2.flex-wrap
					.d-flex
						.pe-3
							p.fs-14.mb-1 Media count
							h2.mb-0.fs-16=media_count || 0
					.d-flex.align-items-center.justify-content-between.gap-2.flex-wrap
						.input-icon.position-relative.me-2
							input.form-control(
								type="text"
								placeholder="Search Keyword"
								value=query.search || ""
							)
							span.input-icon-addon.d-inline-flex.p-2.header-search-icon
								i.ti.ti-command
						.dropdown.me-2
							a.dropdown-toggle.btn.btn-outline-light.shadow(
								href="javascript:void(0);"
								data-bs-toggle="dropdown"
								aria-expanded="false"
							) Filter

							.dropdown-menu.dropdown-menu-end
								a.dropdown-item.filter(data-sort="az") A to Z
								a.dropdown-item.filter(data-sort="za") Z to A
								a.dropdown-item.filter(data-sort="newest") Newest
								a.dropdown-item.filter(data-sort="oldest") Oldest
								a.dropdown-item.filter(data-sort="largest") Largest
								a.dropdown-item.filter(data-sort="smallest") Smallest
						button.btn.btn-primary(
							type="button"
							data-bs-toggle="modal"
							data-bs-target="#UploadModel"
							)
								i.ti.ti-upload.me-1
								| Upload


	.row 
		.col-lg-4.col-xl-3 
			.card.blog-item
				.card-body
					.blog-img.rounded.position-relative.mb-3.banding-box
						img(src=data.cover_image, alt="Cover image").img-fluid.mb-2
					.blog-content  
						.d-flex.align-items-center.justify-content-between
							span.btn.btn-xs.px-3.fs-12.btn-outline-dark(
								type="button"
								data-bs-toggle="modal"
								data-bs-target="#EditCoverImage"
								)
								i.ti.ti-edit.me-1
								| Edit 
							span.btn.btn-xs.px-3.fs-12.btn-outline-danger
								i.ti.ti-trash.me-1
								| Delete 
			span.btn.btn-primary.w-100.mb-2(
				type="button"
				data-bs-toggle="modal"
				data-bs-target="#CreateCollection"
			)
				i.ti.ti-square-rounded-plus-filled.me-1
				| Create Collection 


			#CollectionAccordion.accordion.accordion-bordered.custom-collect
				//- Basic Info
				.accordion-item.rounded.mb-3
					.accordion-header
						a.accordion-button.accordion-custom-button.rounded(
							href="#"
							data-bs-toggle="collapse"
							data-bs-target="#basic"
						)
							span.avatar.avatar-md.rounded.me-1
								i.ti.ti-library
							| Collection

					#basic.accordion-collapse.collapse.show(data-bs-parent="#CollectionAccordion")
						.accordion-body.border-top
							ul.collection-items
								li
									a(href="javascript:void(0);")
										i.ti.ti-photo.me-1
										| All Photos
								each item in collections
									li.collect-width-edit(class=`${query.collection_id == item.id ? 'active' : ''}`)
										a(href="?collection_id=" + item.id)
											if item.name === 'Highlights'
												i.ti.ti-star.me-1
											else if item.name === 'Stories'
												i.ti.ti-circle.me-1
											else 
												i.ti.ti-library-photo.me-1
											| #{item.name}
										if item.name !== 'Highlights' && item.name !== 'Stories'
											span.edit_collection_button(data-id=item.id style="cursor: pointer;")
												i.ti.ti-pencil.me-1(data-id=item.id)

		.col-lg-8.col-xl-9
			.masonry
				each item in media
					.position-relative.item
						.download 
							a(href=`${item.path}` download)
								i.ti.ti-download
						input.bank-radio(type="checkbox" name="image" value=item.id id=item.id).select_images
						.bank-box
							.check-icon
							img(src=item.thumbnail_path alt=item.name)



	//- Create collection model
	.modal.fade#CreateCollection(tabindex="-1" role="dialog" aria-hidden="true")
		.modal-dialog.modal-dialog-centered
			.modal-content
				.modal-header
					h5.card-title Create Collection
					button.btn-close(
						type="button"
						data-bs-dismiss="modal"
						aria-label="Close"
					)
				.modal-body
					form(action='/collection' method="POST").row.create_collection_form
						.col-lg-12
							.mb-3
								label.form-label(for="input-label") Collection Name
								input.form-control(type="text" placeholder="Enter Collection Name" name='name')
								input(type="hidden" name="event_id" value=data.id)
						.col-12.text-end
							button.btn.btn-primary Submit
	//- Edit collection model
	.modal.fade#EditCollection(tabindex="-1" role="dialog" aria-hidden="true")
		.modal-dialog.modal-dialog-centered
			.modal-content
				.modal-header
					h5.card-title Edit Collection
					button.btn-close(
						type="button"
						data-bs-dismiss="modal"
						aria-label="Close"
					)
				.modal-body
					form(action='/collection' method="PUT").row.update_collection_form
						.col-lg-12
							.mb-3
								label.form-label(for="input-label") Collection Name
								input.form-control(type="text" placeholder="Enter Collection Name" name='name')
								input(type="hidden" name="event_id" value=data.id)
								input(type="hidden" name="id")
						.col-12.text-end
							button.btn.btn-danger.delete_collection_button(type="button") Delete Collection
							button.btn.btn-primary.mx-2 Edit
	//- Edit collection model
	.modal.fade#UploadModel(data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true")
		.modal-dialog.modal-dialog-centered.modal-xl.modal-dialog-scrollable
			.modal-content
				.modal-header
					h5.card-title Upload your files and images here
					button.btn-close(
						type="button"
						data-bs-dismiss="modal"
						aria-label="Close"
					)
				.modal-body
					form(action='/collection' method="PUT").row.update_collection_form
						.col-lg-12
							.mb-3
								label.form-label(for="input-label") Select Collection
								select.form-select(name="collection_id") 
									each item in collections
										option(value=item.id) #{item.name}
						.col-lg-12
							.mb-3
								label.form-label(for="input-label") Files
								input(type="hidden" name="event_id" value=data.id)
								input#filePicker(type="file" multiple  accept=".jpg,.jpeg,.png,.webp,.gif,.bmp,.tiff")
					hr
					#filePreviewList
					hr
					.text-end
						button.btn.btn-primary.mx-2#startUploadBtn Upload
	//- Edit Cover Image model
	.modal.fade#EditCoverImage(tabindex="-1" role="dialog" aria-hidden="true")
		.modal-dialog.modal-dialog-centered
			.modal-content
				.modal-header
					h5.card-title Edit Cover Image
					button.btn-close(
						type="button"
						data-bs-dismiss="modal"
						aria-label="Close"
					)
				.modal-body
					form(action='' method="").row
						.col-lg-12.mb-3
							label.form-label(for="input-label") Upload Image
							input.form-control(type="file" name="cover_image")
						.col-12.text-end
							button.btn.btn-danger.me-2(type="button") Cancel
							button.btn.btn-primary Edit
	
	.button_menu_container.d-none
		+bottom_menu(media_count, collections)
block js
	script(src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js")
	script(src="/javascripts/collection.js")
	script(src="/javascripts/upload.js")